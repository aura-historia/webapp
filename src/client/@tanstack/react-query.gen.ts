// This file is auto-generated by @hey-api/openapi-ts

import { queryOptions, type UseMutationOptions } from '@tanstack/react-query';

import { client } from '../client.gen';
import { addWatchlistItem, complexSearchItems, createSearchFilter, deleteSearchFilter, deleteWatchlistItem, getItem, getSearchFilter, getSearchFilters, getShop, getWatchlistItems, type Options, putItems, searchItems, searchShops, updateSearchFilter } from '../sdk.gen';
import type { AddWatchlistItemData, AddWatchlistItemError, ComplexSearchItemsData, ComplexSearchItemsError, ComplexSearchItemsResponse, CreateSearchFilterData, CreateSearchFilterError, CreateSearchFilterResponse, DeleteSearchFilterData, DeleteSearchFilterError, DeleteSearchFilterResponse, DeleteWatchlistItemData, DeleteWatchlistItemError, DeleteWatchlistItemResponse, GetItemData2, GetSearchFilterData, GetSearchFiltersData, GetShopData2, GetWatchlistItemsData, PutItemsData, PutItemsError, PutItemsResponse2, SearchItemsData, SearchShopsData, SearchShopsError, SearchShopsResponse, UpdateSearchFilterData, UpdateSearchFilterError, UpdateSearchFilterResponse } from '../types.gen';

export type QueryKey<TOptions extends Options> = [
    Pick<TOptions, 'baseUrl' | 'body' | 'headers' | 'path' | 'query'> & {
        _id: string;
        _infinite?: boolean;
        tags?: ReadonlyArray<string>;
    }
];

const createQueryKey = <TOptions extends Options>(id: string, options?: TOptions, infinite?: boolean, tags?: ReadonlyArray<string>): [
    QueryKey<TOptions>[0]
] => {
    const params: QueryKey<TOptions>[0] = { _id: id, baseUrl: options?.baseUrl || (options?.client ?? client).getConfig().baseUrl } as QueryKey<TOptions>[0];
    if (infinite) {
        params._infinite = infinite;
    }
    if (tags) {
        params.tags = tags;
    }
    if (options?.body) {
        params.body = options.body;
    }
    if (options?.headers) {
        params.headers = options.headers;
    }
    if (options?.path) {
        params.path = options.path;
    }
    if (options?.query) {
        params.query = options.query;
    }
    return [
        params
    ];
};

export const getItemQueryKey = (options: Options<GetItemData2>) => createQueryKey('getItem', options);

/**
 * Get a single item
 * Retrieves a single item by its shop ID and shop's item ID.
 * Returns localized content based on Accept-Language header and currency preferences.
 * Optionally includes item history when requested.
 *
 */
export const getItemOptions = (options: Options<GetItemData2>) => {
    return queryOptions({
        queryFn: async ({ queryKey, signal }) => {
            const { data } = await getItem({
                ...options,
                ...queryKey[0],
                signal,
                throwOnError: true
            });
            return data;
        },
        queryKey: getItemQueryKey(options)
    });
};

export const searchItemsQueryKey = (options: Options<SearchItemsData>) => createQueryKey('searchItems', options);

/**
 * Search items
 * Search for items using a text query with various filtering and sorting options.
 * Returns a paginated collection of items matching the search criteria.
 *
 */
export const searchItemsOptions = (options: Options<SearchItemsData>) => {
    return queryOptions({
        queryFn: async ({ queryKey, signal }) => {
            const { data } = await searchItems({
                ...options,
                ...queryKey[0],
                signal,
                throwOnError: true
            });
            return data;
        },
        queryKey: searchItemsQueryKey(options)
    });
};

/**
 * Bulk create or update items
 * Creates or updates multiple items in a single batch request.
 * This endpoint accepts a collection of item data and processes them asynchronously.
 *
 * **Shop Enrichment**: The shop information (shopId and shopName) is automatically
 * enriched based on the item's URL. The URL must belong to a shop that is already
 * registered in the system. If the shop is not found, the item will fail with
 * a SHOP_NOT_FOUND error.
 *
 * **Response Structure**:
 * - `skipped`: Number of items that had no changes and were skipped
 * - `unprocessed`: URLs of items that could not be processed due to temporary issues (can be retried)
 * - `failed`: Map of item URLs to error codes for items that permanently failed processing
 *
 * Returns information about any items that could not be processed or failed during enrichment.
 *
 */
export const putItemsMutation = (options?: Partial<Options<PutItemsData>>): UseMutationOptions<PutItemsResponse2, PutItemsError, Options<PutItemsData>> => {
    const mutationOptions: UseMutationOptions<PutItemsResponse2, PutItemsError, Options<PutItemsData>> = {
        mutationFn: async (fnOptions) => {
            const { data } = await putItems({
                ...options,
                ...fnOptions,
                throwOnError: true
            });
            return data;
        }
    };
    return mutationOptions;
};

/**
 * Complex item search
 * Performs an advanced search for items using a comprehensive search filter.
 * This endpoint accepts a SearchFilterData object in the request body,
 * allowing for complex filtering by multiple criteria simultaneously.
 * Returns a paginated collection of items matching the search criteria.
 *
 */
export const complexSearchItemsMutation = (options?: Partial<Options<ComplexSearchItemsData>>): UseMutationOptions<ComplexSearchItemsResponse, ComplexSearchItemsError, Options<ComplexSearchItemsData>> => {
    const mutationOptions: UseMutationOptions<ComplexSearchItemsResponse, ComplexSearchItemsError, Options<ComplexSearchItemsData>> = {
        mutationFn: async (fnOptions) => {
            const { data } = await complexSearchItems({
                ...options,
                ...fnOptions,
                throwOnError: true
            });
            return data;
        }
    };
    return mutationOptions;
};

export const getSearchFiltersQueryKey = (options: Options<GetSearchFiltersData>) => createQueryKey('getSearchFilters', options);

/**
 * List user search filters
 * Retrieves all search filters for the authenticated user.
 * Results can be optionally sorted by creation date.
 * Requires valid Cognito JWT authentication.
 *
 */
export const getSearchFiltersOptions = (options: Options<GetSearchFiltersData>) => {
    return queryOptions({
        queryFn: async ({ queryKey, signal }) => {
            const { data } = await getSearchFilters({
                ...options,
                ...queryKey[0],
                signal,
                throwOnError: true
            });
            return data;
        },
        queryKey: getSearchFiltersQueryKey(options)
    });
};

/**
 * Create a new search filter
 * Creates a new search filter for the authenticated user.
 * The search filter configuration is provided in the request body.
 * Returns the created search filter with generated ID and metadata.
 * Requires valid Cognito JWT authentication.
 *
 */
export const createSearchFilterMutation = (options?: Partial<Options<CreateSearchFilterData>>): UseMutationOptions<CreateSearchFilterResponse, CreateSearchFilterError, Options<CreateSearchFilterData>> => {
    const mutationOptions: UseMutationOptions<CreateSearchFilterResponse, CreateSearchFilterError, Options<CreateSearchFilterData>> = {
        mutationFn: async (fnOptions) => {
            const { data } = await createSearchFilter({
                ...options,
                ...fnOptions,
                throwOnError: true
            });
            return data;
        }
    };
    return mutationOptions;
};

/**
 * Delete a search filter
 * Deletes a specific search filter by its ID for the authenticated user.
 * The search filter must exist and belong to the authenticated user.
 * Requires valid Cognito JWT authentication.
 *
 */
export const deleteSearchFilterMutation = (options?: Partial<Options<DeleteSearchFilterData>>): UseMutationOptions<DeleteSearchFilterResponse, DeleteSearchFilterError, Options<DeleteSearchFilterData>> => {
    const mutationOptions: UseMutationOptions<DeleteSearchFilterResponse, DeleteSearchFilterError, Options<DeleteSearchFilterData>> = {
        mutationFn: async (fnOptions) => {
            const { data } = await deleteSearchFilter({
                ...options,
                ...fnOptions,
                throwOnError: true
            });
            return data;
        }
    };
    return mutationOptions;
};

export const getSearchFilterQueryKey = (options: Options<GetSearchFilterData>) => createQueryKey('getSearchFilter', options);

/**
 * Get a specific search filter
 * Retrieves a specific search filter by its ID for the authenticated user.
 * Returns the complete search filter configuration and metadata.
 * Requires valid Cognito JWT authentication.
 *
 */
export const getSearchFilterOptions = (options: Options<GetSearchFilterData>) => {
    return queryOptions({
        queryFn: async ({ queryKey, signal }) => {
            const { data } = await getSearchFilter({
                ...options,
                ...queryKey[0],
                signal,
                throwOnError: true
            });
            return data;
        },
        queryKey: getSearchFilterQueryKey(options)
    });
};

/**
 * Update a search filter
 * Updates a specific search filter by its ID for the authenticated user.
 * Allows partial updates - only provided fields will be modified.
 * If no fields are provided in the request body, returns the existing search filter unchanged.
 * Requires valid Cognito JWT authentication.
 *
 */
export const updateSearchFilterMutation = (options?: Partial<Options<UpdateSearchFilterData>>): UseMutationOptions<UpdateSearchFilterResponse, UpdateSearchFilterError, Options<UpdateSearchFilterData>> => {
    const mutationOptions: UseMutationOptions<UpdateSearchFilterResponse, UpdateSearchFilterError, Options<UpdateSearchFilterData>> = {
        mutationFn: async (fnOptions) => {
            const { data } = await updateSearchFilter({
                ...options,
                ...fnOptions,
                throwOnError: true
            });
            return data;
        }
    };
    return mutationOptions;
};

export const getWatchlistItemsQueryKey = (options: Options<GetWatchlistItemsData>) => createQueryKey('getWatchlistItems', options);

/**
 * List user's watchlist items
 * Retrieves all items in the authenticated user's watchlist.
 * Results are paginated using search-after cursor-based pagination with timestamp.
 * Requires valid Cognito JWT authentication.
 *
 */
export const getWatchlistItemsOptions = (options: Options<GetWatchlistItemsData>) => {
    return queryOptions({
        queryFn: async ({ queryKey, signal }) => {
            const { data } = await getWatchlistItems({
                ...options,
                ...queryKey[0],
                signal,
                throwOnError: true
            });
            return data;
        },
        queryKey: getWatchlistItemsQueryKey(options)
    });
};

/**
 * Add item to watchlist
 * Adds an item to the authenticated user's watchlist.
 * The request body must contain the shop ID and shop's item ID.
 * Returns a 201 Created response with a Location header pointing to the created resource.
 * Requires valid Cognito JWT authentication.
 *
 */
export const addWatchlistItemMutation = (options?: Partial<Options<AddWatchlistItemData>>): UseMutationOptions<unknown, AddWatchlistItemError, Options<AddWatchlistItemData>> => {
    const mutationOptions: UseMutationOptions<unknown, AddWatchlistItemError, Options<AddWatchlistItemData>> = {
        mutationFn: async (fnOptions) => {
            const { data } = await addWatchlistItem({
                ...options,
                ...fnOptions,
                throwOnError: true
            });
            return data;
        }
    };
    return mutationOptions;
};

/**
 * Remove item from watchlist
 * Removes a specific item from the authenticated user's watchlist.
 * Requires the creation timestamp as a query parameter to identify the exact watchlist entry.
 * Returns a 204 No Content response on success.
 * Requires valid Cognito JWT authentication.
 *
 */
export const deleteWatchlistItemMutation = (options?: Partial<Options<DeleteWatchlistItemData>>): UseMutationOptions<DeleteWatchlistItemResponse, DeleteWatchlistItemError, Options<DeleteWatchlistItemData>> => {
    const mutationOptions: UseMutationOptions<DeleteWatchlistItemResponse, DeleteWatchlistItemError, Options<DeleteWatchlistItemData>> = {
        mutationFn: async (fnOptions) => {
            const { data } = await deleteWatchlistItem({
                ...options,
                ...fnOptions,
                throwOnError: true
            });
            return data;
        }
    };
    return mutationOptions;
};

export const getShopQueryKey = (options: Options<GetShopData2>) => createQueryKey('getShop', options);

/**
 * Get shop details
 * Retrieves detailed information about a specific shop by its unique identifier.
 * Returns complete shop metadata including name, URL, image, and timestamps.
 *
 */
export const getShopOptions = (options: Options<GetShopData2>) => {
    return queryOptions({
        queryFn: async ({ queryKey, signal }) => {
            const { data } = await getShop({
                ...options,
                ...queryKey[0],
                signal,
                throwOnError: true
            });
            return data;
        },
        queryKey: getShopQueryKey(options)
    });
};

/**
 * Search shops
 * Performs an advanced search for shops using comprehensive filtering criteria.
 * This endpoint accepts a ShopSearchData object in the request body,
 * allowing for complex filtering by shop name and date ranges.
 * Returns a paginated collection of shops matching the search criteria.
 *
 */
export const searchShopsMutation = (options?: Partial<Options<SearchShopsData>>): UseMutationOptions<SearchShopsResponse, SearchShopsError, Options<SearchShopsData>> => {
    const mutationOptions: UseMutationOptions<SearchShopsResponse, SearchShopsError, Options<SearchShopsData>> = {
        mutationFn: async (fnOptions) => {
            const { data } = await searchShops({
                ...options,
                ...fnOptions,
                throwOnError: true
            });
            return data;
        }
    };
    return mutationOptions;
};
